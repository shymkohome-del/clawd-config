# Story 6.3: Rate limiting enforcement

## Status
Draft

## Dependencies

- 6.2 Audit logging baseline

## Story

As a platform, we need per-user rate limiting to prevent abuse and ensure fairness.

## Acceptance Criteria

1. Given repeated calls from the same principal, when the rate exceeds the threshold, then further calls are rejected with RATE_LIMIT_EXCEEDED. [Source: architecture/coding-standards.md#critical-fullstack-rules]
2. Given rate limits are enforced, when the user slows down, then calls succeed again after cooldown. [Source: architecture/backend-architecture.md#canister-based-service-architecture]

### BDD Scenarios

- Scenario: Exceed limit
  - Given I rapidly call `createListing`
  - When the count exceeds threshold
  - Then I receive RATE_LIMIT_EXCEEDED

- Scenario: Cooldown
  - Given my rate is limited
  - When I wait the cooldown period
  - Then my next request succeeds

## Tasks / Subtasks

- [ ] Backend: Implement per-principal counters/time windows in canisters. [Source: architecture/backend-architecture.md#canister-based-service-architecture]
- [ ] Error mapping: Return structured error with code `RATE_LIMIT_EXCEEDED`. [Source: architecture/error-handling-strategy.md#error-response-format]
- [ ] Testing: Unit tests for limit and cooldown behavior. [Source: architecture/testing-strategy.md#test-organization]

## Dev Notes

- Track counters in stable structures; reset windows efficiently. [Source: architecture/backend-architecture.md#canister-based-service-architecture]

## Change Log

| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| YYYY-MM-DD | 0.1 | Initial draft created for Story 6.3 | Scrum Master |

## Dev Agent Record

- Agent Model Used: _TBD_
- Debug Log References: _TBD_
- Completion Notes List: _TBD_
- File List: _TBD_

## QA Results

_TBD_



# Story 6.2: Audit logging baseline

## Status
Ready for Review

## Dependencies

- 0.6 Logging & error handling baseline
- 8.1 Observability baseline

## Story

As an operator, I need audit logs for key actions so that we can trace user actions and meet compliance needs.

## Acceptance Criteria

1. Given key events (listing created, swap initiated/completed/refunded/disputed), when they occur, then they are logged with principal, timestamp, and identifiers. [Source: prd/4a-epics-and-capabilities.md#epic-e6-compliance-&-limits]
2. Given audit logs exist, when I query them (manual for MVP), then I can reconstruct a trade timeline. [Source: architecture/monitoring-and-observability.md#key-metrics]

### BDD Scenarios

- Scenario: Log swap initiation
  - Given a user initiates a swap
  - When the call returns
  - Then a structured log entry is written

- Scenario: Log refund
  - Given a swap refunds
  - When the refund completes
  - Then the event is logged

## Tasks / Subtasks

- [ ] Backend: Add structured logging in canisters for key events (AC: 1) [Source: architecture/monitoring-and-observability.md#key-metrics]
- [ ] Frontend: Append breadcrumbs for trade lifecycle in dev builds (AC: 1) [Source: architecture/monitoring-and-observability.md#monitoring-stack]
- [ ] Documentation: Define event schema and retention policy (AC: 2)

## Dev Notes

- Include fields: `eventType`, `principal`, `entityId`, `timestamp`, `metadata`. [Source: architecture/error-handling-strategy.md#error-response-format]

## Testing

- Verify:
  - Logs appear for each key event
  - Fields are populated and consistent

## Change Log

| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| YYYY-MM-DD | 0.1 | Initial draft created for Story 6.2 | Scrum Master |

## Dev Agent Record

- Agent Model Used: _TBD_
- Debug Log References: _TBD_
- Completion Notes List: _TBD_
- File List: _TBD_

## QA Results

_TBD_



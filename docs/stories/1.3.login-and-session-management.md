# Story 1.3: Login and session management

## Status
Review

## Dependencies

- 1.1 Register with email/social
- 0.3 Config and secrets baseline

## Story

As a user, I want to log in and have my session restored securely so I can continue where I left off.

## Acceptance Criteria

1. Given valid credentials, when I log in, then I am authenticated and navigated to the home screen. [Source: architecture/backend-architecture.md#authentication-architecture]
2. Given a valid session, when I reopen the app, then I remain authenticated until expiry. [Source: architecture/security-and-performance.md#security-requirements]
3. Given I tap logout, when confirmed, then my session is cleared. [Source: architecture/coding-standards.md#project-baseline-standards-flutter-dart]

### BDD Scenarios

- Scenario: Successful login
  - Given valid email/password
  - When I log in
  - Then I see my home screen and profile is loaded

- Scenario: Session restore
  - Given I have a valid session
  - When I relaunch the app
  - Then I remain logged in

- Scenario: Logout
  - Given I am logged in
  - When I log out
  - Then I am returned to the login screen and session is cleared

## Tasks / Subtasks

- [ ] Frontend: Login UI and session persistence (AC: 1, 2)
  - [ ] Create `LoginScreen` with form validation and OAuth buttons. [Source: architecture/frontend-architecture.md#flutter-app-structure]
  - [ ] Integrate auth state management with secure storage. [Source: architecture/frontend-architecture.md#state-management-architecture]
  - [ ] Handle session expiry and auto-refresh logic. [Source: architecture/core-workflows.md#oauth-login-flow]
  - [ ] **Localization: Implement multi-language support for login form labels, authentication messages, session timeout notifications, and OAuth provider labels.**

- [ ] Testing (AC: 1, 2, 3)
  - [ ] Widget and integration tests for login, restore, logout. [Source: architecture/testing-strategy.md#test-organization]

## Dev Notes

### APIs

- `authenticate(email, password) -> Result<User, Text>`. [Source: architecture/api-specification.md#user-management-canister]

### Structure

- `lib/features/auth/screens/login_screen.dart`, providers under `lib/features/auth/providers/`. [Source: architecture/frontend-architecture.md#flutter-app-structure]

## Testing

- Verify:
  - Successful login navigates and loads profile
  - Session persists within expiry
  - Logout clears state and storage

## Change Log

| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| YYYY-MM-DD | 0.1 | Initial draft created for Story 1.3 | Scrum Master |

## Dev Agent Record

- Agent Model Used: _TBD_
- Debug Log References: _TBD_
- Completion Notes List: _TBD_
- File List: _TBD_

## QA Results

_TBD_



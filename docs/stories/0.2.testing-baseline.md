# Story 0.2: Testing baseline

## Status
Done

## Dependencies

- 0.1 Repo & CI baseline

## Story

As a developer, I want a testing baseline and folder structure so that unit, widget, and integration tests are easy to add and run in CI.

## Acceptance Criteria

1. Test folders created: `test/unit/`, `test/integration/`, `test/e2e/` (e2e optional). [Source: architecture/testing-strategy.md#test-organization]
2. Sample widget test at `test/unit/widgets/sample_widget_test.dart` passes locally and in CI. [Source: architecture/testing-strategy.md#test-examples]
3. CI runs `flutter test --reporter expanded` and surfaces failures. [Source: docs/architecture/testing-strategy.md#test-organization]

### BDD Scenarios

- Scenario: Sample widget test passes in CI
  - Given the sample widget test exists at `test/unit/widgets/sample_widget_test.dart`
  - When CI runs `flutter test --reporter expanded`
  - Then the test passes and failures are surfaced by CI

## Tasks / Subtasks

- [x] Create folders `test/unit/`, `test/integration/`, `test/e2e/`. (AC: 1)
- [x] Add `test/unit/widgets/sample_widget_test.dart` using provided widget test pattern. (AC: 2)
- [x] Ensure CI step executes tests with `--reporter expanded` and surfaces failures. (AC: 3)
- [x] Document how to run tests locally in `README.md`. (AC: 3)

## Dev Notes

- Use example tests from the strategy doc to validate setup. [Source: docs/architecture/testing-strategy.md#test-examples]

## Testing

- Ensure the sample widget test runs headless in CI and passes (path: `test/unit/widgets/sample_widget_test.dart`). [Source: docs/architecture/testing-strategy.md#test-examples]

## Change Log

| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| YYYY-MM-DD | 0.1 | Initial draft for testing baseline | Scrum Master |
| 2025-09-06 | 0.2 | Dev: Verified local format/analyze/tests; removed accidental AppleDouble test artifacts (._*.dart) to prevent UTF-8 decode crashes; analyzer clean, tests pass. | Dev |
| 2025-09-09 | 0.3 | Dev: Confirmed CI uses expanded reporter; added Local Testing section to README; ran gates locally (clean). | Dev |

## Dev Agent Record

- Agent Model Used: GPT-5
- Debug Log References: `.ai/debug-log.md`
- Completion Notes List:
  - Created test directories: `test/unit/`, `test/integration/`, `test/e2e/` (with `.gitkeep` for empty dirs)
  - Added sample widget test at `test/unit/widgets/sample_widget_test.dart`
  - Ensured CI runs tests; local tests passing
  - Documented local test commands and structure in `README.md`
- File List:
  - Modified: `.github/workflows/flutter-ci.yml`
  - Modified: `README.md`
  - Added: `crypto_market/test/unit/widgets/sample_widget_test.dart`
  - Added: `crypto_market/test/integration/.gitkeep`
  - Added: `crypto_market/test/e2e/.gitkeep`

## QA Results

Re-review:

- Evidence:
  - Present: `crypto_market/test/unit/widgets/sample_widget_test.dart`
  - Present: `crypto_market/test/integration/.gitkeep`, `crypto_market/test/e2e/.gitkeep`
  - Local tests pass with `flutter test --reporter expanded`

- Acceptance Criteria:
  - [x] AC1: Folders created
  - [x] AC2: Sample widget test exists and passes locally
  - [x] AC3: CI configured to run tests (expanded reporter recommended)

- Outcome: Looks Ready for Review. Proceed to CI verification.
  
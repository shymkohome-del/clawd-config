# Story 0.4: App structure alignment

## Status
Done

## Dependencies

- 0.1 Repo & CI baseline

## Story

As a developer, I want the Flutter app folders, routes, and providers aligned with the architecture, so that teams can navigate and extend features consistently.

## Acceptance Criteria

1. Directory structure under `lib/` matches `features/`, `core/`, and `shared/` guidance. [Source: docs/architecture/frontend-architecture.md#flutter-app-structure]
2. Initial routes scaffolded and documented: `/login`, `/register`, `/home`. [Source: docs/architecture/frontend-architecture.md#routing-architecture]
3. Any deltas from the monorepo structure are documented in this repo. [Source: docs/architecture/unified-project-structure.md#monorepo-structure]

## Key Files to Verify/Create

- `crypto_market/lib/features/auth/`
- `crypto_market/lib/features/market/` (normalize from any `marketplace` mentions)
- `crypto_market/lib/shared/`
- Routes: `/login`, `/register`, `/home` in `crypto_market/lib/main.dart` or router file

## References

- `docs/architecture/frontend-architecture.md#flutter-app-structure`
- `docs/architecture/frontend-architecture.md#routing-architecture`

### BDD Scenarios

- Scenario: Base routes are navigable
  - Given the app builds successfully
  - When I navigate from `/login` to `/register` to `/home`
  - Then no runtime errors occur and each screen renders

## Tasks / Subtasks

- [x] Ensure presence of `lib/features/auth/`, `lib/features/market/`, `lib/shared/`, and `lib/core/blockchain/`. (AC: 1) [Source: docs/architecture/frontend-architecture.md#flutter-app-structure]
- [x] Define base routes `/login`, `/register`, `/home` with placeholder screens. (AC: 2) [Source: docs/architecture/frontend-architecture.md#routing-architecture]
- [x] Document structure and any deviations in `README.md`. (AC: 3)

## Dev Notes

- Follow the proposed feature-module structure and Bloc/Cubit placement. [Source: docs/architecture/frontend-architecture.md#state-management-architecture]
- This repo is a single Flutter app; capture the divergence from the monorepo in notes. [Source: docs/architecture/unified-project-structure.md#monorepo-structure]

## Testing

- Verify app builds and can navigate `/login` → `/register` → `/home` without runtime errors. [Source: docs/architecture/testing-strategy.md#test-organization]
- Widget test: basic navigation route smoke test.

## Change Log

| Date | Version | Description | Author |
| ---- | ------- | ----------- | ------ |
| YYYY-MM-DD | 0.1 | Initial draft for app structure alignment | Scrum Master |
| 2025-08-14 | 0.2 | QA: Changes requested — AC3 not met (README structure/deltas missing). Status set to InProgress. | Quinn |
| 2025-08-14 | 0.3 | Dev: Updated README with structure and deltas; verified routes and widget test; quality gates green. Status set to Ready for Review. | James |
| 2025-08-14 | 0.4 | QA: Verified all ACs; tests green; set Status to Done. | Quinn |

## Dev Agent Record

- Agent Model Used: GPT-5
- Debug Log References:
  - Format, analyze, tests passed in `crypto_market/` app directory (widget smoke test included)
  - Branch: `story/0.4-app-structure-alignment`
- Completion Notes List:
  - AC1: Verified folder structure present under `lib/`
  - AC2: Routes `/login`, `/register`, `/home` in `lib/main.dart` and navigable
  - AC3: `README.md` updated with structure and monorepo deltas
- File List:
  - Modified: `README.md`
  - Modified: `docs/stories/0.4.app-structure-alignment.md`

## QA Results

Quinn (Senior Developer & QA Architect)

- Findings:
  - Status: Passed
  - Evidence:
    - Structure present: `lib/features/{auth,market,chat,payments,profile}`, `lib/shared/{models,theme,utils,widgets}`, `lib/core/blockchain/{errors.dart,icp_service.dart}` (AC1)
    - Routes present and navigable in `lib/main.dart`: `/login`, `/register`, `/home` with placeholder screens; widget smoke test `test/widget_test.dart` passes (AC2)
    - `README.md` documents the app structure and monorepo deltas, citing architecture docs (AC3)
  - Re-test checklist:
    - App builds and navigates `/login` → `/register` → `/home` without runtime errors: OK
    - Widget test passes: OK
